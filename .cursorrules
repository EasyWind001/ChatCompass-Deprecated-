# ChatCompass Project Rules for AI Assistants

## ğŸ¯ Quick Reference

**Before any code change, AI assistants must:**
1. âœ… Check current branch (never work on main/develop)
2. âœ… Run tests before commit
3. âœ… Use parameterized SQL queries (NO string concatenation)
4. âœ… Follow commit message format: `<type>(<scope>): <subject>`

## ğŸ“š Full Documentation

- **Complete Guide**: [CONTRIBUTING.md](CONTRIBUTING.md)
- **Branch Management**: [docs/BRANCH_MANAGEMENT.md](docs/BRANCH_MANAGEMENT.md)
- **AI Assistant Rules**: [.ai-assistant-rules.md](.ai-assistant-rules.md)

## ğŸ”’ Security Rules (MANDATORY)

### Rule #1: SQL Injection Prevention

```python
# âœ… CORRECT - Parameterized query
cursor.execute("SELECT * FROM conversations WHERE title = ?", (user_input,))

# âŒ FORBIDDEN - String concatenation (SQL injection risk)
cursor.execute(f"SELECT * FROM conversations WHERE title = '{user_input}'")
```

### Rule #2: Input Validation

```python
# âœ… CORRECT - Validate all user input
if not title or len(title) > 500:
    raise ValueError("Invalid title")
```

### Rule #3: No Sensitive Data

```python
# âŒ FORBIDDEN
API_KEY = "sk-abc123..."

# âœ… CORRECT
API_KEY = os.getenv("OPENAI_API_KEY")
```

## ğŸŒ³ Branch Rules

```bash
# âŒ FORBIDDEN
git checkout main
git push origin main

# âœ… CORRECT
git checkout develop
git checkout -b feature/your-feature
# ... develop ...
git push origin feature/your-feature
# Then create PR on GitHub
```

**Branch Naming:**
- `feature/<name>` - New features
- `bugfix/<name>` - Bug fixes
- `hotfix/v<version>-<name>` - Critical fixes

## ğŸ“ Commit Message Format

```
<type>(<scope>): <subject>

Types: feat, fix, docs, style, refactor, perf, test, chore
```

**Examples:**
```bash
git commit -m "feat(scraper): add Gemini support"
git commit -m "fix(search): resolve encoding error"
git commit -m "test(db): add query validation tests"
```

## ğŸ§ª Testing Rules

```bash
# âœ… MUST run before commit
python -m pytest tests/ -v

# âœ… MUST pass all tests
# âœ… MUST add tests for new features
```

## ğŸš« Forbidden Operations

1. âŒ Direct push to main/develop
2. âŒ Skip tests
3. âŒ SQL string concatenation
4. âŒ Commit sensitive data (passwords, keys)
5. âŒ Commit temp files (*.db, __pycache__)
6. âŒ Ignore test failures

## âœ… Pre-Commit Checklist

- [ ] Not on main/develop branch
- [ ] Branch name follows convention
- [ ] All tests pass
- [ ] SQL uses parameters
- [ ] No sensitive data
- [ ] Commit message follows format
- [ ] Documentation updated
- [ ] No temp files

## ğŸ†˜ Emergency Contacts

- Project Issues: https://github.com/EasyWind001/ChatCompass/issues
- Full Rules: [.ai-assistant-rules.md](.ai-assistant-rules.md)

---

**Remember: Security first, Quality over Speed!** ğŸ›¡ï¸
